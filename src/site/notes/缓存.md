---
{"dg-publish":true,"permalink":"//","tags":["gardenEntry"]}
---


请求资源 
- 资源响应头的 cache-control
	- 协商缓存 304 public,max-age=0
	- 强缓存 public，max-age=xxx;并且设置过期时间 结合 hash 决定更新的文件
	- 无缓存 no-store  每次都重新获取资源

- **200 OK (from disk cache/memory cache):** 表示浏览器从缓存中获取了资源。浏览器之前已经下载过 `vite.svg`，并将其存储在缓存中。当再次请求该资源时，浏览器会检查缓存，如果资源未过期且有效，则直接从缓存中读取，而无需再次向服务器发送请求。
- **304 Not Modified:** 表示浏览器向服务器发送了请求，询问 `vite.svg` 是否有更新。服务器检查后发现资源没有变化，因此返回 304 状态码，告诉浏览器使用缓存中的版本。浏览器收到 304 后，会从缓存中加载 `vite.svg`。

```bash
location ~* \.(js|css|png|jpg|jpeg|gif|svg|woff|woff2)$ {
  root /path/to/your/dist; # 替换为你的项目dist目录
  expires 30d; # 缓存30天
  add_header Cache-Control "public";
}  
```

这三个指令是相互配合的，缺少任何一个都无法实现完整的静态资源缓存控制。 它们一起确保 Nginx 正确地提供静态资源，并指示浏览器和 CDN 如何缓存这些资源，从而提高网站的性能和加载速度。


在浏览器的开发者工具 (F12) 中，你可以通过以下步骤查看资源的缓存信息，包括缓存时间：

1. **打开开发者工具：** 按 F12 键，或者右键点击页面选择“检查”或“审查元素”。
2. **切换到 "Network" (网络) 标签页。**
3. **刷新页面：** 确保网络请求被记录。
4. **找到你想要查看的资源：** 例如，`vite.svg`。
5. **点击资源名称：** 这会打开一个详细面板。
6. **查看 "Headers" (标头) 信息：** 在详细面板中，查找 "Response Headers" (响应标头) 部分。

在 "Response Headers" 中，你可以找到以下与缓存相关的标头：

- **Cache-Control:** 这是最重要的缓存控制标头。它包含了各种指令，例如：
    - `max-age=31536000`: 表示资源可以被缓存的秒数 (这里是 1 年)。
    - `public`: 表示资源可以被任何缓存（例如，CDN、代理服务器或浏览器）缓存。
    - `private`: 表示资源只能被用户的浏览器缓存，不能被 CDN 或代理服务器缓存。
    - `no-cache`: 表示每次使用缓存的资源前，都必须向服务器验证资源是否已过期。
    - `no-store`: 表示不允许缓存资源。
- **Expires:** 指定资源过期的具体日期和时间。这是一个较旧的缓存控制标头，通常与 `Cache-Control` 一起使用。
- **Age:** 表示资源在缓存中存储的时间（秒）。
- **Last-Modified:** 表示资源最后修改的时间。
- **ETag:** 资源的唯一标识符。浏览器可以使用 ETag 来验证缓存的资源是否已过期。

**如何确定缓存是否生效？**

- **Status Code (状态码):**
    - `200 OK (from disk cache)` 或 `200 OK (from memory cache)`: 表示资源是从缓存中加载的。
    - `304 Not Modified`: 表示浏览器向服务器发送了请求，但服务器告诉浏览器可以使用缓存的版本。
- **查看 "Timing" (时间) 信息：** 在详细面板中，还可以找到 "Timing" 部分，它显示了请求各个阶段的时间。如果资源是从缓存中加载的，则 "Timing" 信息会显示非常短的加载时间。


